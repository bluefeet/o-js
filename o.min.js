// o.js : DEVELOPMENT VERSION : https://o-js.com : MIT License
(function(){var a=this,b=a.o,c={};a.o=c,a.oJS=c,c.noConflict=function(){return a.o=b,c};var d=function(a,b){return function(){var c=a.apply(this,arguments);return b.call(this),c}};c.after=d;var e=function(a,b){return function(){var c=this,d=Array.prototype.slice.call(arguments),e=function(){return a.apply(c,arguments)};return d.unshift(e),b.apply(c,d)}};c.around=e;var f=function(a,b){return function(){return b.call(this),a.apply(this,arguments)}};c.before=f;var g=function(a){return function(){delete this[a]}};c.clearer=g;var h=function(a){return Object.getPrototypeOf?Object.getPrototypeOf(a):Object.__proto__};c.getPrototypeOf=h;var i=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};c.has=i;var j=function(a,b,c){var d,e=i(a,b),f=a[b];try{d=c()}finally{e?a[b]=f:delete a[b]}return d};c.local=j;var k=function(){for(var a=Array.prototype.slice.call(arguments),b=a.shift();a.length;){var c=a.shift();for(var d in c)i(c,d)&&(b[d]=c[d])}return b};c.merge=k;var l=function(a){return function(){return i(this,a)&&void 0!==this[a]}};c.predicate=l;var m=function(a,b){return function(){return this[a][b].apply(this[a],arguments)}};c.proxy=m;var n={};c.traitBootstrap=n;var o=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};c.ucFirst=o;var p=function(a,b){return b=b||{},b.augments&&(b.type=b.type||"object"),function(c){if(b.filter&&(c=b.filter.call(this,c)),b.type)if("string"==typeof b.type||b.type instanceof String){if(typeof c!==b.type)throw new Error(c+" failed validation.")}else if(b.type instanceof Function){if(!b.type(c))throw new Error(c+" failed validation.")}else b.type.coerce instanceof Function&&b.type.validate instanceof Function&&(b.coerce?c=b.type.coerce(c):b.type.validate(c));if(b.augments&&!(c instanceof b.augments))throw new Error(c+" failed validation.");var d=this[a];return this[a]=c,b.chain?this:d}};c.writer=p;var q=function(a){var b=Object.create(h(a));return b.constructor=a.constructor,k(b,a),b};c.clone=q;var r=function(a,b){return k(a.prototype,b),a};c.construct=r;var s=function(a,b){return b=b||{},b.writer=b.writer||p(a,b),b.predicate=b.predicate||l(a),function(){if(!b.predicate.call(this)){if(b.required)throw new Error(a+" is required.");if(b.devoid){var c=b.devoid;c instanceof Function&&(c=c.call(this)),b.writer.call(this,c)}else b.builder&&b.writer.call(this,this[b.builder].call(this))}return this[a]}};c.reader=s;var t;t=r(function(a){a=a||{},"function"==typeof a&&(a={validate:a}),a.validate&&(this._validateMethod=a.validate),a.coerce&&(this._coerceMethod=a.coerce),a.parent&&(this._parent=a.parent)},{check:function(a){return t.validationDisabled?!0:this._parent&&!this._parent.check(a)?!1:this._validateMethod?this._validateMethod(a)?!0:!1:!0},validate:function(a){if(!this.check(a))throw new Error(a+" failed validation.")},coerce:function(a){return a=this.coerceOnly(a),this.validate(a),a},coerceOnly:function(a){return this._parent&&(a=this._parent.coerceOnly(a)),this._coerceMethod&&(a=this._coerceMethod(a)),a},subtype:function(a){return"function"==typeof a&&(a={validate:a}),new t(k({parent:this},a))}}),t.validationDisabled=!1,c.Type=t;var u=function(a,b){return b=b||{},b.writer=b.writer||p(a,b),b.reader=b.reader||s(a,b),function(a){return void 0!==a?b.writer.call(this,a):b.reader.call(this)}};c.accessor=u;var v=function(a,b,c){var d=e(a,b);return childProto=Object.create(a.prototype),c&&k(childProto,c),d.prototype=childProto,d};c.augment=v;var w=function(a){return a?j(t,"validationDisabled",function(){return t.validationDisabled=!0,a()}):void(t.validationDisabled=!0)};c.disableTypeValidation=w;var x=v(t,function(a,b,c){c=c||{},c.validate=function(a){for(var c in b)if(!b[c].check(a))return!1;return!0},a(c)});c.AllType=x;var y=v(t,function(a,b,c){c=c||{},c.validate=function(a){for(var c=0,d=b.length;d>c;c++)if(b[c].check(a))return!0;return!1},a(c)});c.AnyType=y;var z=v(t,function(a,b,c){c=c||{},c.validate=function(a){for(var c in b)if(a===b[c])return!0;return!1},a(c)});c.EnumType=z;var A=v(t,function(a,b,c){c=c||{},c.validate=function(a){return a===b?!0:!1},a(c)});c.EqualType=A;var B=v(t,function(a,b,c){c=c||{},c.validate=function(a){return a instanceof b?!0:!1},c.coerce=function(a){return this.check(a)?a:new b(a)},a(c)});c.InstanceOfType=B;var C=v(t,function(a,b,c){c=c||{};var d=new y(b);c.validate=function(a){return d.check(a)?!1:!0},a(c)});c.NoneType=C;var D=v(C,function(a,b,c){a([b],c)});c.NotType=D;var E=v(t,function(a,b,c){c=c||{},c.validate=function(a){return typeof a===b?!0:!1},a(c)});c.TypeOfType=E;var F=new B(Array);c.arrayType=F;var G=new y([new E("boolean"),new B(Boolean)]);c.booleanType=G;var H=new B(Date);c.dateType=H;var I=new B(Function);c.functionType=I;var J=new A(null);c.nullType=J;var K=new y([new E("number"),new B(Number)]);c.numberType=K;var L=new B(Object);c.objectType=L;var M=K.subtype(function(a){return a>0?!0:!1});c.positiveType=M;var N=new B(RegExp);c.regExpType=N;var O=L.subtype(function(a){return a.constructor===Object?!0:!1});c.simpleObjectType=O;var P=new y([new E("string"),new B(String)]);c.stringType=P;var Q=new B(t);c.typeType=Q;var R=new A(void 0);c.undefinedType=R;var S=v(t,function(a,b,c){c=c||{},c.validate=function(a){if(!F.check(a))return!1;for(var c in a)if(!b.check(a[c]))return!1;return!0},c.coerce=function(a){if(!this.check(a))return a;for(var c in a)a[c]=b.coerce(a[c]);return a},a(c)});c.ArrayOfType=S;var T=v(t,function(a,b,c){c=c||{},c.validate=function(a){if(!L.check(a))return!1;if(F.check(b)){for(var c in b)if(void 0===a[b[c]])return!1;return!0}if(O.check(b)){for(var d in b){if(void 0===a[d])return!1;if(!b[d].check(a[d]))return!1}return!0}return!1},a(c)});c.DuckType=T;var U=v(t,function(a,b,c){c=c||{},c.validate=function(a){if(!L.check(a))return!1;for(var c in a)if(!b.check(a[c]))return!1;return!0},c.coerce=function(a){if(!this.check(a))return a;for(var c in a)a[c]=b.coerce(a[c]);return a},a(c)});c.ObjectOfType=U;var V=v(t,function(a,b,c){c=c||{},c.validate=function(a){return P.check(a)?b.test(a):!1},a(c)});c.PatternType=V;var W=v(t,function(a,b,c){c=c||{},c.validate=function(a){if(!F.check(a))return!1;if(a.length!=b.length)return!1;for(var c in a){if(!b[c])return!1;if(!b[c].check(a[c]))return!1}return!0},c.coerce=function(a){if(!this.check(a))return a;for(var c in a)b[c]&&(a[c]=b[c].coerce(a[c]));return a},a(c)});c.TupleType=W;var X=new D(R);c.definedType=X;var Y=new V(/^[A-Za-z_$][A-Za-z_$0-9]*$/);c.identifierType=Y;var Z=K.subtype(function(a){return Math.floor(a)===a+0?!0:!1});c.integerType=Z;var $=K.subtype(function(a){return 0>a?!0:!1});c.negativeType=$;var _=P.subtype(function(a){return a.length>0?!0:!1});c.nonEmptyStringType=_;var aa=K.subtype(function(a){return 0!==a?!0:!1});c.nonZeroType=aa;var ba=new x([Z,M]);c.positiveIntType=ba;var ca=new y([G,Y]),da={key:{type:Y,required:!0},argKey:{type:new y([Y,J]),devoid:function(){return this.key()}},valueKey:{type:Y,devoid:function(){return"_"+this.key()}},devoid:{type:X},builder:{type:ca,filter:function(a){return a===!0&&(a="build"+o(this.key())),a}},required:{type:G},type:{type:new y([new z(["undefined","object","boolean","number","string","function"]),Q,I])},coerce:{type:G},filter:{type:I},augments:{type:I},chain:{type:G},reader:{type:ca,devoid:!0,filter:function(a){return a===!0&&(a=this.key()),a}},writer:{type:ca,filter:function(a){return a===!0&&(a=this.key()),a}},predicate:{type:ca,filter:function(a){return a===!0&&(a="has"+o(this.key())),a}},clearer:{type:ca,filter:function(a){return a===!0&&(a="clear"+o(this.key())),a}},proxies:{type:new U(Y)}},ea={},fa={};for(var ga in da)ea[ga]=p("_"+ga,da[ga]),fa[ga]=s("_"+ga,k({writer:ea[ga]},da[ga]));var ha=r(function(a){if(a=a||{},this._originalArgs=q(a),a.traits){var b=new n.o_Trait({traits:a.traits});b.install(this,a)}ea.key.call(this,a.key);for(var c in a)ea[c]&&ea[c].call(this,a[c])},k({readerMethod:s("_readerMethod",{type:I,devoid:function(){return s(this.valueKey(),{devoid:this.devoid(),builder:this.builder(),required:this.required(),writer:this.writerMethod(),predicate:this.predicateMethod()})}}),writerMethod:s("_writerMethod",{type:I,devoid:function(){return p(this.valueKey(),{type:this.type(),coerce:this.coerce(),filter:this.filter(),augments:this.augments(),chain:this.chain()})}}),accessorMethod:s("_accessorMethod",{type:I,devoid:function(){return u(this.valueKey(),{writer:this.writerMethod(),reader:this.readerMethod()})}}),predicateMethod:s("_predicateMethod",{type:I,devoid:function(){return l(this.valueKey())}}),clearerMethod:s("_clearerMethod",{type:I,devoid:function(){return g(this.valueKey())}}),proxyMethods:s("_proxyMethods",{type:new U(I),devoid:function(){var a={},b=this.proxies();if(void 0===b)return a;var c=this;for(var d in b)a[d]=function(a){return function(){var b=c.getValue(this);return b[a].apply(b,arguments)}}(b[d]);return a}}),getValue:function(a){return this.readerMethod().call(a)},setValue:function(a,b){return this.writerMethod().call(a,b)},hasValue:function(a){return this.predicateMethod().call(a)},clearValue:function(a){return this.clearerMethod().call(a)},setValueFromArgs:function(a,b){return this.argKey()&&void 0!==b[this.argKey()]?this.setValue(a,b[this.argKey()]):void 0},install:function(a,b){this.writer()&&this.writer()===this.reader()?a[this.writer()]=this.accessorMethod():(this.writer()&&(a[this.writer()]=this.writerMethod()),this.reader()&&(a[this.reader()]=this.readerMethod())),this.predicate()&&(a[this.predicate()]=this.predicateMethod()),this.clearer()&&(a[this.clearer()]=this.clearerMethod());var c=this.proxyMethods();for(var d in c)a[d]=c[d];return b&&this.setValue(a,b),a},rebuild:function(a){var b=this.constructor;return new b(k({},this._originalArgs,a))}},fa));c.Attribute=ha;var ia=new B(ha);c.attributeType=ia;var ja,ka;ka=r(function(a){"function"==typeof a&&(a=this.functionToArgs(a)),a=a||{};for(var b in ja)ja[b].setValueFromArgs(this,a)},{functionToArgs:function(a){var b={requires:[],traits:[],attributes:{},methods:{},around:{},before:{},after:{}},c={require:function(a){b.requires.push(a)},trait:function(a){b.traits.push(a)},attribute:function(a,c){b.attributes[a]=c},method:function(a,c){b.methods[a]=c},around:function(a,c){b.around[a]=c},before:function(a,c){b.before[a]=c},after:function(a,c){b.after[a]=c}};return a.apply(c),b},install:function(a,b){var c,g,h=this.requires();h&&h.validate(a);var i=this.methods();for(g in i)a[g]=i[g];var j=this.traits();for(c in j)j[c].install(a);var k=this.attributes();for(g in k)k[g].install(a);var l=this.around();for(g in l)a[g]=e(a[g],l[g]);var m=this.before();for(g in m)a[g]=f(a[g],m[g]);var n=this.after();for(g in n)a[g]=d(a[g],n[g]);return b&&this.setFromArgs(a,b),a},setFromArgs:function(a,b,c){var d=this.attributes();c||(c={});var e,f;for(f in d)c[f]||d[f].filter()||(d[f].setValueFromArgs(a,b),c[f]=!0);for(f in d)c[f]||d[f].filter()&&(d[f].setValueFromArgs(a,b),c[f]=!0);var g=this.traits();for(e in g)g[e].setFromArgs(a,b,c)},buildType:function(){var a,b,c={},d=this.attributes();for(b in d){var e=d[b];e.reader()&&(c[e.reader()]=I),e.writer()&&(c[e.writer()]=I),e.predicate()&&(c[e.predicate()]=I),e.clearer()&&(c[e.clearer()]=I)}for(b in this.methods())c[b]=I;var f=/^_/m;for(b in c)b.match(f)&&delete c[b];c=new T(c);var g=this.traits();if(!g.length)return c;var h=[c];for(a in g)h.push(g[a].type());return new x(h)}}),ja=[{key:"requires",type:new B(T),coerce:!0},{key:"traits",type:new S(new B(ka)),devoid:function(){return[]}},{key:"attributes",type:new U(ia),devoid:function(){return{}},filter:function(a){var b={};for(var c in a){var d=a[c];ia.check(d)?d.key()!==c&&(d=d.rebuild({key:c})):d=new ha(k({},d,{key:c})),b[c]=d}return b}},{key:"methods",type:new U(I),devoid:function(){return{}}},{key:"around",type:new U(I),devoid:function(){return{}}},{key:"before",type:new U(I),devoid:function(){return{}}},{key:"after",type:new U(I),devoid:function(){return{}}},{key:"type",type:Q,builder:!0,argKey:null}];var la=ka.prototype;for(var ma in ja)ja[ma]=new ha(ja[ma]),ja[ma].install(la);n.o_Trait=ka,c.Trait=ka;var na=new B(ka);c.traitType=na;var oa=new ka({attributes:{type:{type:Q,builder:!0,argKey:null},trait:{type:na,required:!0}},methods:{buildType:function(){return new B(this)}}});c.classTrait=oa;var pa=r(function(a){var b=new ka(a),c=function(a){a=a||{},b.setFromArgs(this,a)};return b.install(c.prototype),oa.install(c,{trait:b}),c});c.Class=pa;var qa=oa.type().subtype({coerce:function(a){return this.check(a)?a:new pa(a)}});c.classType=qa}).call(this);