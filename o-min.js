// o.js : v0.0.9 : http://o-js.com : MIT License
(function(){var E=this,$=E.o,d={};E.o=d;E.oJS=d;d.noConflict=function(){E.o=$;return d};var T=function(a,c){return function(){var b=a.apply(this,arguments);c.call(this);return b}};d.after=T;var L=function(a,c){return function(){var b=this,e=Array.prototype.slice.call(arguments);e.unshift(function(){return a.apply(b,arguments)});return c.apply(b,e)}};d.around=L;var U=function(a,c){return function(){c.call(this);return a.apply(this,arguments)}};d.before=U;var V=function(a){return function(){delete this[a]}};
d.clearer=V;var F=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};d.has=F;d.local=function(a,c,b){var e=F(a,c),d=a[c],f;try{f=b()}finally{e?a[c]=d:delete a[c]}return f};var v=function(){for(var a=Array.prototype.slice.call(arguments),c=a.shift();a.length;){var b=a.shift(),e;for(e in b)F(b,e)&&(c[e]=b[e])}return c};d.merge=v;var M=function(a){return function(){return F(this,a)&&void 0!==this[a]}};d.predicate=M;d.proxy=function(a,c){return function(){return this[a][c].apply(this[a],
arguments)}};var G=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};d.ucFirst=G;var C=function(a,c){c=c||{};c.augments&&(c.type=c.type||"object");return function(b){c.filter&&(b=c.filter.call(this,b));if(c.type)if("string"===typeof c.type||c.type instanceof String){if(typeof b!==c.type)throw Error(b+" failed validation.");}else if(c.type instanceof Function){if(!c.type(b))throw Error(b+" failed validation.");}else c.type.coerce instanceof Function&&c.type.validate instanceof Function&&(c.coerce?
b=c.type.coerce(b):c.type.validate(b));if(c.augments&&!(b instanceof c.augments))throw Error(b+" failed validation.");var e=this[a];this[a]=b;return c.chain?this:e}};d.writer=C;var N=function(a){var c=v({},a);c.__proto__=a.__proto__;c.constructor=a.constructor;return c};d.clone=N;var x=function(a,c){v(a.prototype,c);return a};d.construct=x;var r=function(a,c){c=c||{};c.writer=c.writer||C(a,c);c.predicate=c.predicate||M(a);return function(){if(!c.predicate.call(this)){if(c.required)throw Error(a+" is required.");
if(c.devoid){var b=c.devoid;b instanceof Function&&(b=b.call(this));c.writer.call(this,b)}else c.builder&&c.writer.call(this,this[c.builder].call(this))}return this[a]}};d.reader=r;var k;k=x(function(a){a=a||{};"function"===typeof a&&(a={validate:a});a.validate&&(this._validateMethod=a.validate);a.coerce&&(this._coerceMethod=a.coerce);a.parent&&(this._parent=a.parent)},{check:function(a){return this._parent&&!this._parent.check(a)?!1:this._validateMethod?this._validateMethod(a)?!0:!1:!0},validate:function(a){if(!this.check(a))throw Error(a+
" failed validation.");},coerce:function(a){a=this.coerceOnly(a);this.validate(a);return a},coerceOnly:function(a){this._parent&&(a=this._parent.coerceOnly(a));this._coerceMethod&&(a=this._coerceMethod(a));return a},subtype:function(a){"function"===typeof a&&(a={validate:a});return new k(v({parent:this},a))}});d.Type=k;var W=function(a,c){c=c||{};c.writer=c.writer||C(a,c);c.reader=c.reader||r(a,c);return function(a){return void 0!==a?c.writer.call(this,a):c.reader.call(this)}};d.accessor=W;var g=
function(a,c,b){var e=L(a,c);b=b?v({},c.prototype,b):N(c.prototype);b.__proto__=a.prototype;e.prototype=b;return e};d.augment=g;var O=g(k,function(a,c,b){b=b||{};b.validate=function(a){for(var b=0,d=c.length;b<d;b++)if(!c[b].check(a))return!1;return!0};a(b)});d.AllType=O;var w=g(k,function(a,c,b){b=b||{};b.validate=function(a){for(var b=0,d=c.length;b<d;b++)if(c[b].check(a))return!0;return!1};a(b)});d.AnyType=w;var n=g(k,function(a,c,b){b=b||{};b.validate=function(a){for(var b=0,d=c.length;b<d;b++)if(a===
c[b])return!0;return!1};a(b)});d.EnumType=n;var y=g(k,function(a,c,b){b=b||{};b.validate=function(a){return a===c?!0:!1};a(b)});d.EqualType=y;var l=g(k,function(a,c,b){b=b||{};b.validate=function(a){return a instanceof c?!0:!1};b.coerce=function(a){return this.check(a)?a:new c(a)};a(b)});d.InstanceOfType=l;var p=g(k,function(a,c,b){b=b||{};var e=new w(c);b.validate=function(a){return e.check(a)?!1:!0};a(b)});d.NoneType=p;var q=g(p,function(a,c,b){a([c],b)});d.NotType=q;p=g(k,function(a,c,b){b=b||
{};b.validate=function(a){return typeof a===c?!0:!1};a(b)});d.TypeOfType=p;var P=new l(Array);d.arrayType=P;var s=new w([new p("boolean"),new l(Boolean)]);d.booleanType=s;var H=new l(Date);d.dateType=H;var h=new l(Function);d.functionType=h;H=new y(null);d.nullType=H;var z=new w([new p("number"),new l(Number)]);d.numberType=z;var I=new l(Object);d.objectType=I;var t=z.subtype(function(a){return 0<a?!0:!1});d.positiveType=t;var u=new l(RegExp);d.regExpType=u;var X=I.subtype(function(a){return a.constructor===
Object?!0:!1});d.simpleObjectType=X;var Q=new w([new p("string"),new l(String)]);d.stringType=Q;p=new l(k);d.typeType=p;var D=new y(void 0);d.undefinedType=D;y=g(k,function(a,c,b){b=b||{};b.validate=function(a){if(!P.check(a))return!1;for(var b=0,d=a.length;b<d;b++)if(!c.check(a[b]))return!1;return!0};b.coerce=function(a){if(!this.check(a))return a;for(var b=0,d=a.length;b<d;b++)a[b]=c.coerce(a[b]);return a};a(b)});d.ArrayOfType=y;var Y=g(k,function(a,c,b){b=b||{};b.validate=function(a){if(!I.check(a))return!1;
if(P.check(c)){for(var b=0,d=c.length;b<d;b++)if(void 0===a[c[b]])return!1;return!0}if(X.check(c)){for(b in c)if(void 0===a[b]||!c[b].check(a[b]))return!1;return!0}return!1};a(b)});d.DuckType=Y;u=g(k,function(a,c,b){b=b||{};b.validate=function(a){if(!I.check(a))return!1;for(var b in a)if(!c.check(a[b]))return!1;return!0};b.coerce=function(a){if(!this.check(a))return a;for(var b in a)a[b]=c.coerce(a[b]);return a};a(b)});d.ObjectOfType=u;g=g(k,function(a,c,b){b=b||{};b.validate=function(a){return Q.check(a)?
c.test(a):!1};a(b)});d.PatternType=g;g=new q(D);d.definedType=g;D=z.subtype(function(a){return Math.floor(a)===a+0?!0:!1});d.integerType=D;q=z.subtype(function(a){return 0>a?!0:!1});d.negativeType=q;q=Q.subtype(function(a){return 0<a.length?!0:!1});d.nonEmptyStringType=q;z=z.subtype(function(a){return 0!==a?!0:!1});d.nonZeroType=z;t=new O([D,t]);d.positiveIntType=t;var t=new w([s,q]),n={key:{type:q,required:!0},argKey:{type:new w([q,H]),devoid:function(){return this.key()}},valueKey:{type:q,devoid:function(){return"_"+
this.key()}},devoid:{type:g},builder:{type:t,devoid:!1,filter:function(a){!0===a&&(a="build"+G(this.key()));return a}},required:{type:s,devoid:!1},type:{type:new w([new n("undefined object boolean number string function".split(" ")),p,h])},coerce:{type:s,devoid:!1},filter:{type:h},augments:{type:h},chain:{type:s,devoid:!1},reader:{type:t,devoid:!0,filter:function(a){!0===a&&(a=this.key());return a}},writer:{type:t,devoid:!1,filter:function(a){!0===a&&(a=this.key());return a}},predicate:{type:t,devoid:!1,
filter:function(a){!0===a&&(a="has"+G(this.key()));return a}},clearer:{type:t,devoid:!1,filter:function(a){!0===a&&(a="clear"+G(this.key()));return a}},proxies:{type:new u(q)}},J={},s={},m;for(m in n)J[m]=C("_"+m,n[m]),s[m]=r("_"+m,v({writer:J[m]},n[m]));var K=x(function(a){this._originalArgs=N(a);J.key.call(this,a.key);for(var c in a)J[c].call(this,a[c])},v({readerMethod:r("_readerMethod",{type:h,devoid:function(){return r(this.valueKey(),{devoid:this.devoid(),builder:this.builder(),required:this.required(),
writer:this.writerMethod(),predicate:this.predicateMethod()})}}),writerMethod:r("_writerMethod",{type:h,devoid:function(){return C(this.valueKey(),{type:this.type(),coerce:this.coerce(),filter:this.filter(),augments:this.augments(),chain:this.chain()})}}),accessorMethod:r("_accessorMethod",{type:h,devoid:function(){return W(this.valueKey(),{writer:this.writerMethod(),reader:this.readerMethod()})}}),predicateMethod:r("_predicateMethod",{type:h,devoid:function(){return M(this.valueKey())}}),clearerMethod:r("_clearerMethod",
{type:h,devoid:function(){return V(this.valueKey())}}),proxyMethods:r("_proxyMethods",{type:new u(h),devoid:function(){var a={},c=this.proxies();if(void 0===c)return a;var b=this,e;for(e in c)a[e]=function(a){return function(){var c=b.getValue(this);return c[a].apply(c,arguments)}}(c[e]);return a}}),getValue:function(a){return this.readerMethod().call(a)},setValue:function(a,c){return this.writerMethod().call(a,c)},hasValue:function(a){return this.predicateMethod().call(a)},clearValue:function(a){return this.clearerMethod().call(a)},
setValueFromArgs:function(a,c){if(null!==this.argKey()&&void 0!==c[this.argKey()])return this.setValue(a,c[this.argKey()])},install:function(a,c){null!==this.writer()&&this.writer()===this.reader()?a[this.writer()]=this.accessorMethod():(null!==this.writer()&&(a[this.writer()]=this.writerMethod()),null!==this.reader()&&(a[this.reader()]=this.readerMethod()));null!==this.predicate()&&(a[this.predicate()]=this.predicateMethod());null!==this.clearer()&&(a[this.clearer()]=this.clearerMethod());var b=
this.proxyMethods(),e;for(e in b)a[e]=b[e];c&&this.setValue(a,c);return a},rebuild:function(a){return new this.constructor(v({},this._originalArgs,a))}},s));d.Attribute=K;var R=new l(K);d.attributeType=R;var A,B;B=x(function(a){for(var c=0,b=A.length;c<b;c++)A[c].setValueFromArgs(this,a)},{install:function(a,c){for(var b=this.requires(),e=0,d=b.length;e<d;e++)if(void 0===a[b[e]])throw Error(required[e]+" is required.");b=this.traits();e=0;for(d=b.length;e<d;e++)b[e].install(a);var e=this.attributes(),
f;for(f in e)e[f].install(a);e=this.methods();for(f in e)a[f]=e[f];e=this.around();for(f in e)a[f]=L(a[f],e[f]);e=this.before();for(f in e)a[f]=U(a[f],e[f]);e=this.after();for(f in e)a[f]=T(a[f],e[f]);c&&this.setFromArgs(a,c);return a},setFromArgs:function(a,c){var b=this.attributes(),d;for(d in b)b[d].filter()||b[d].setValueFromArgs(a,c);for(d in b)b[d].filter()&&b[d].setValueFromArgs(a,c)},buildType:function(){var a={},c=this.attributes(),b;for(b in c){var d=c[b];d.reader()&&(a[d.reader()]=h);d.writer()&&
(a[d.writer()]=h);d.predicate()&&(a[d.predicate()]=h);d.clearer()&&(a[d.clearer()]=h)}for(b in this.methods())a[b]=h;c=/^_/m;for(b in a)b.match(c)&&delete a[b];a=new Y(a);b=this.traits();if(!b.length)return a;a=[a];c=0;for(d=b.length;c<d;c++)a.push(b[c].type());return new O(a)}});A=[{key:"requires",type:new y(g),devoid:function(){return[]}},{key:"traits",type:new y(new l(B)),devoid:function(){return[]}},{key:"attributes",type:new u(R),devoid:function(){return{}},filter:function(a){var c={},b;for(b in a){var d=
a[b];R.check(d)?d.key()!==b&&(d=d.rebuild({key:b})):d=new K(v({},d,{key:b}));c[b]=d}return c}},{key:"methods",type:new u(h),devoid:function(){return{}}},{key:"around",type:new u(h),devoid:function(){return{}}},{key:"before",type:new u(h),devoid:function(){return{}}},{key:"after",type:new u(h),devoid:function(){return{}}},{key:"type",type:p,builder:!0,argKey:null}];m=B.prototype;n=0;for(s=A.length;n<s;n++)A[n]=new K(A[n]),A[n].install(m);d.Trait=B;m=new l(B);d.traitType=m;var S=new B({attributes:{type:{type:p,
builder:!0,argKey:null},trait:{type:m,required:!0}},methods:{buildType:function(){return new l(this)}}});d.classTrait=S;var Z=x(function(a){var c=new B(a);a=function(a){c.setFromArgs(this,a)};c.install(a.prototype);S.install(a,{trait:c});return a});d.Class=Z;x=S.type().subtype({coerce:function(a){return this.check(a)?a:new Z(a)}});d.classType=x}).call(this);
